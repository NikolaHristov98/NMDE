(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16572,        422]
NotebookOptionsPosition[     15361,        397]
NotebookOutlinePosition[     15732,        413]
CellTagsIndexPosition[     15689,        410]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"EulerForward", "[", 
   RowBox[{
   "du_", ",", " ", "du0_", ",", " ", "t0_", ",", " ", "T_", ",", " ", "n_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "t", ",", " ", "h", ",", " ", "y", ",", " ", "i", ",", " ", "ret"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"t0", ",", "T", ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      FractionBox[
       RowBox[{"T", "-", "t0"}], "n"]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Length", "[", "t", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "du0"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "2"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "t", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], "+", 
          RowBox[{"h", 
           RowBox[{"(", 
            RowBox[{"du", "[", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], "]"}], ")"}]}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8248141272365236`*^9, 3.824814132578456*^9}, {
  3.8248142079448485`*^9, 3.824814231918687*^9}, {3.8248142696590366`*^9, 
  3.8248142994756203`*^9}, {3.8248143336596494`*^9, 3.82481437868861*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"4abc4d52-9b35-4804-b371-d2006c36cf71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EulerBackwardsV1", "[", 
   RowBox[{
   "du_", ",", "du0_", ",", " ", "t0_", ",", " ", "T_", ",", " ", "n_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "t", ",", " ", "h", ",", " ", "y", ",", " ", "i", ",", " ", "ret", ",", 
      " ", "aprY"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"aprY", " ", "=", " ", 
      RowBox[{"EulerForward", "[", 
       RowBox[{
       "du", ",", "du0", ",", " ", "t0", ",", " ", "T", ",", " ", "n"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"t0", ",", "T", ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      FractionBox[
       RowBox[{"T", "-", "t0"}], "n"]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Length", "[", "t", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "du0"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"Length", "[", "t", "]"}], "-", "1"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "=", 
        RowBox[{"fy", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"fy", " ", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"h", "*", 
              RowBox[{"du", "[", "fy", "]"}]}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"fy", ",", " ", 
             RowBox[{"aprY", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "}"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8248145614887123`*^9, 3.8248146726484604`*^9}, {
  3.824814814920827*^9, 3.8248148227879553`*^9}, {3.8248150354800143`*^9, 
  3.824815035692677*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"51ae7de8-490f-44f9-b6ee-a85d3d20714c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "u_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "10"}], "u"}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"90317a0d-f71a-4bd5-8352-ad1752262eb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewtonSolve", "[", 
   RowBox[{"f_", ",", " ", "x0_", ",", " ", "nmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xprev", ",", " ", "xcurr", ",", " ", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xprev", " ", "=", " ", "x0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", "nmax"}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xcurr", " ", "=", " ", 
         RowBox[{"xprev", "-", 
          FractionBox[
           RowBox[{"f", "/.", 
            RowBox[{"x", "->", "xprev"}]}], 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"f", ",", " ", "x"}], "]"}], "/.", 
            RowBox[{"x", "->", "xprev"}]}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"xcurr", "-", "xprev"}], "]"}], "<", 
           SuperscriptBox["10", "6"]}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "xcurr", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xprev", "=", "xcurr"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "xcurr"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.824815160797547*^9, 3.8248152058611937`*^9}, {
  3.824815321730273*^9, 3.824815519863452*^9}, {3.8248156471364737`*^9, 
  3.824815668370497*^9}, {3.8248159048071423`*^9, 3.824815922613648*^9}, {
  3.824816220379469*^9, 3.824816259969859*^9}, {3.824816437893406*^9, 
  3.824816438256981*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"82bcdd6a-ac9d-4cb9-b886-c2daf3455705"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EulerBackwardsV2", "[", 
   RowBox[{
   "du_", ",", "du0_", ",", " ", "t0_", ",", " ", "T_", ",", " ", "n_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "t", ",", " ", "h", ",", " ", "y", ",", " ", "i", ",", " ", "ret", ",", 
      " ", "aprY"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"aprY", " ", "=", " ", 
      RowBox[{"EulerForward", "[", 
       RowBox[{
       "du", ",", "du0", ",", " ", "t0", ",", " ", "T", ",", " ", "n"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"t0", ",", "T", ",", "n"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"h", " ", "=", " ", 
      FractionBox[
       RowBox[{"T", "-", "t0"}], "n"]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Length", "[", "t", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "du0"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{
         RowBox[{"Length", "[", "t", "]"}], "-", "1"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", " ", 
         RowBox[{"NewtonSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"h", "*", 
             RowBox[{"du", "[", "x", "]"}]}], "-", "x"}], ",", " ", 
           RowBox[{"aprY", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], ",", "10"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "t", "]"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.824815626237257*^9, 3.824815633665386*^9}, {
   3.8248156805023165`*^9, 3.8248157056984167`*^9}, {3.824815742815487*^9, 
   3.82481577349302*^9}, {3.824815866312615*^9, 3.824815876006548*^9}, {
   3.8248159545467215`*^9, 3.8248159783206096`*^9}, 3.824816105668764*^9, {
   3.8248162936048956`*^9, 3.824816293813888*^9}, {3.8248164181222253`*^9, 
   3.8248164261809673`*^9}, {3.8248165712988696`*^9, 3.8248165714210606`*^9}, 
   3.8248166135046997`*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"557b0c7b-b9a5-4c8e-b0be-41b4e2928193"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8248157812029123`*^9, 
  3.824815786406246*^9}},ExpressionUUID->"b70dcf15-667c-4a54-9f5c-\
56fcc68c95c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "u_", "]"}], ":=", 
   RowBox[{"10", "u", 
    RowBox[{"(", 
     RowBox[{"1", "-", "u"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8248158078455753`*^9, 3.8248158259650626`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"1196ce76-f1e8-47be-8984-9b38de53ee20"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8248158283125677`*^9, 
  3.8248158306287055`*^9}},ExpressionUUID->"032c5082-86c3-460d-b627-\
90c3c8a20415"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"EulerBackwardsV2", "[", 
   RowBox[{"f", ",", " ", "0.1", ",", " ", "0", ",", "6", ",", " ", "55"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.824815846376416*^9, 3.8248158542403183`*^9}, 
   3.8248166111120825`*^9, {3.824816670731216*^9, 3.8248166817958775`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"fba0a0ad-1b86-461a-a604-66403fbf4558"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxF011IU2EYB/CTTSvNj33UgrpwFxLeaDBQE/F5duGNZYFJjDBEoS5cYMUC
jYQYEZRd7GJeWCgzL1agfRBBmi1h9KUFzUTRIl2OsIUdZ61WZztv5/042wuH
w49zzvM+z//l2Dq6mk/lSJJUo130rq+bA3SNw/re+WD7+lNoDXpmr71YEp4B
v7cp6Tz0DTZ9pUd3bM6Bsrh84L33h3j+Eca+tAekSzK4ww3Wk+4InJiuH78z
JYv3o2Cc2Ff5JCLDWady9XHXGlRJB3uuxGXx/Xe4m398wfRXBtfyg9+FLhms
9wb/3E/p9eJQvf+wq1OVwc7WTzjjnMmrJ3r9X3Ar/LV2RPND7WutBCSbJoc/
EH2/JMRb37yKaa6cWLvdV/EPmm2pxQTR91fgcn93maJ5tDe0VD2ahra652Np
ovdDYC40vapq7qfb+SQMFpu7CdH724KnU+kgdYunruz1sRz0v1xboeb9bsXS
Tluc2hwtdwyZDHj9wmqSZPo34MUjAylqVi6ci/O+NpVk5snDyEINofYGDD2N
3m3YOOVn5vNtx9rzs8y0O60iDlfFmPm8+ej1JZiL2EAF2GBQmPn8Bfh5MM38
7i1dO9H+SWXmeRTiOTdhvlFBCxah4xk3z6cYLSvc2vBaAiU4ucHN8yrBR0nu
XK37gMGInhQ3z8+ILSo3iydqRDvh5nmacEiYdtMbMmFYmOdrxpjwSB9t0IwJ
YZ63BRVhVs5jQVWY529BItzBAtmF/K/YEOeRNe2u3LE7Y34+WdvYAVgz5ueV
Nb/vyfg/4KThsA==
      "]]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.9989329031934598},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 6.}, {0.9989329031934598, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.824815857585418*^9, 3.8248158833426456`*^9}, {
   3.8248159157134047`*^9, 3.8248159274866643`*^9}, 3.824816110517768*^9, {
   3.824816229232764*^9, 3.824816264538368*^9}, 3.8248163106556077`*^9, 
   3.824816574132854*^9, {3.8248166155681014`*^9, 3.8248166826981964`*^9}},
 CellLabel->"Out[73]=",ExpressionUUID->"2c311c43-c3fe-4e7a-a580-edc70207037a"]
}, Open  ]]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2653, 68, 432, "Input",ExpressionUUID->"4abc4d52-9b35-4804-b371-d2006c36cf71"],
Cell[3214, 90, 3088, 79, 456, "Input",ExpressionUUID->"51ae7de8-490f-44f9-b6ee-a85d3d20714c"],
Cell[6305, 171, 216, 6, 35, "Input",ExpressionUUID->"90317a0d-f71a-4bd5-8352-ad1752262eb9"],
Cell[6524, 179, 1881, 43, 369, "Input",ExpressionUUID->"82bcdd6a-ac9d-4cb9-b886-c2daf3455705"],
Cell[8408, 224, 3278, 80, 456, "Input",ExpressionUUID->"557b0c7b-b9a5-4c8e-b0be-41b4e2928193"],
Cell[11689, 306, 154, 3, 35, "Input",ExpressionUUID->"b70dcf15-667c-4a54-9f5c-56fcc68c95c4"],
Cell[11846, 311, 323, 8, 35, "Input",ExpressionUUID->"1196ce76-f1e8-47be-8984-9b38de53ee20"],
Cell[12172, 321, 156, 3, 35, "Input",ExpressionUUID->"032c5082-86c3-460d-b627-90c3c8a20415"],
Cell[CellGroupData[{
Cell[12353, 328, 403, 7, 35, "Input",ExpressionUUID->"fba0a0ad-1b86-461a-a604-66403fbf4558"],
Cell[12759, 337, 2586, 57, 306, "Output",ExpressionUUID->"2c311c43-c3fe-4e7a-a580-edc70207037a"]
}, Open  ]]
}
]
*)

